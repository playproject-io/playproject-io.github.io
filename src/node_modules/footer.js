const bel = require('bel')
const csjs = require('csjs-inject')
// widgets
const graphic = require('graphic')

async function footer(footer) {
    const css = styles
    let island = await graphic(css.island, './src/node_modules/assets/svg/deco-island.svg')
    const graphics = footer.icons.map(icon => graphic(css.icon, icon.imgURL))
    const icons = await Promise.all(graphics)

    let el = bel`
    <footer class=${css.footer}>
        <div class=${css.scene}>
            ${island}
            <nav class=${css.contacts}>
                ${footer.icons.map((icon, i) => 
                    bel`
                    <a href=${icon.url} 
                    title=${icon.name} 
                    target="${icon.url.includes('http') ? "_blank" : null}"
                    >${icons[i]}</a>`
                )}
            </nav>
        </div>
        
        <p class=${css.copyright}>${footer.copyright}</p>
    </footer>
    `
    return el
}

let styles = csjs`
.footer {
    display: grid;
    grid-template-rows: auto;
    grid-template-columns: 1fr;
    color: var(--footerTextColor);
    padding-top: 4vw;
    padding-bottom: 0.5%;
    background-color: var(--footerBg);
}
.copyright {
    text-align: center;
    align-self: center;
}
.scene {
    position: relative;
    width: 60%;
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-rows: auto;
    grid-template-columns: repeat(4, 25%);
}
.contacts {
    display: flex;
    justify-content: center;
    align-items: center;
    grid-row-start: 2;
    grid-column-start: 2;
    grid-column-end: 4;
    margin-top: -2%;
}
.contacts a {
    margin: 0 2rem;
}
.icon {
    width: 6vw;
}
.island {
    grid-row-start: 1;
    grid-row-end: 6;
    grid-column-start: 1;
    grid-column-end: 5;
}
@media only screen and (min-width: 1440px) {
    .icon {
        max-width: 10rem;
    }
}
@media only screen and (max-width: 1200px) {
    .contacts a {
        margin: 0 1.5vw;
    }
}
@media only screen and (max-width: 1024px) {
    .scene {
        width: 80%;
    }
    .icon {
        width: 8vw;
    }
}
`

module.exports = footer